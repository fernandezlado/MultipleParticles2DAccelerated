THIS PSEUDOCODE DESCRIBES THE COMPUTATION OF THE FORWARD MAP USING THE ACCELERATOR

WE HAVE A GRID OF N_1 x N_2 AND WE ASSUME THAT WE HAVE AT MOST ONE OBSTACLE PER SQUARE INSIDE EACH CELL OF THE GRID. THERE ARE N OBSTACLES N<=N_1 x N_2


Psi=[Psi_1 .. Psi_N]

DO i=1:N
   square_i=OBSTACLE(i).getSquare()
  
   COMPUTE THE EQUIV-SOURCES IN THE SQUARE square_i GIVEN THE FIELD PRODUCED BY THE OBSTACLE INSIDE square_i

END DO

COMPUTE FIELD PRODUCED AT THE EQUIV SOURCES PRODUCED BY THE OTHER EQUIV SOURCES VIA FFT.

DO i=1:N
   square_i=OBSTACLE(i).getSquare()
   COMPUTE FORWARD-MAP OF THE i-th OBSTACLE
   
   PROJECT FIELD OF EQUIV SOURCES INSIDE square_i
   SUBSTRACT FIELD PRODUCED BY NEIGHBORS'S EQUIV SOURCES
   ADD REAL FIELD PRODUCED BY NEIGHBORS VIA INTEGRATION
END DO   

